<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= mode === 'edit' ? 'Edit Student' : 'Add New Student' %></title>
  <link rel="stylesheet" href="/public/css/admin.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    .form-container {
      max-width: 800px;
      margin: 20px auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }
    .form-group input, .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }
    .form-group input:focus, .form-group textarea:focus {
      border-color: #7b2cff;
      outline: none;
    }
    .full-width {
      grid-column: 1 / -1;
    }
    .btn-submit {
      background: #7b2cff;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      font-size: 16px;
      margin-top: 10px;
    }
    .btn-submit:hover {
      background: #6a00ff;
    }
    .preview-img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
      margin-top: 10px;
      border: 2px solid #ddd;
    }
  </style>
</head>
<body class="admin-body">

<header class="dashboard-header">
  <div class="dashboard-title">
    <i class="fa-solid fa-user-pen"></i>
    <%= mode === 'edit' ? 'Edit Student' : 'Add New Student' %>
  </div>
  <div class="dashboard-actions">
    <a href="/admin/registrations" class="btn-upload" style="background:#555;">
      <i class="fa-solid fa-arrow-left"></i> Back to List
    </a>
  </div>
</header>

<div class="dashboard-container">
  
  <% if (error) { %>
    <div style="background:#ffdddd;color:#d8000c;padding:15px;border-radius:8px;margin-bottom:20px;text-align:center;">
      <%= error %>
    </div>
  <% } %>

  <div class="form-container">
    <form action="<%= mode === 'edit' ? '/admin/registrations/edit/' + student.regNumber : '/admin/registrations/add' %>" method="POST" enctype="multipart/form-data">
      
      <div class="form-grid">
        <!-- Personal Details -->
        <div class="form-group">
          <label>Registration Number *</label>
          <input type="text" name="regNumber" value="<%= student.regNumber %>" <%= mode === 'edit' ? 'readonly style="background:#f0f0f0;"' : 'required' %>>
        </div>

        <div class="form-group">
          <label>Date of Birth *</label>
          <input type="date" name="dob" value="<%= student.dob %>" required>
        </div>

        <div class="form-group">
          <label>Student Name *</label>
          <input type="text" name="name" value="<%= student.name %>" required>
        </div>

        <div class="form-group">
          <label>Father's Name</label>
          <input type="text" name="fatherName" value="<%= student.fatherName %>">
        </div>

        <div class="form-group">
          <label>Course</label>
          <select name="course" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
            <option value="" disabled <%= !student.course ? 'selected' : '' %>>Select Course</option>
            <option value="ADCA" <%= student.course === 'ADCA' ? 'selected' : '' %>>ADCA</option>
            <option value="DCA" <%= student.course === 'DCA' ? 'selected' : '' %>>DCA</option>
            <option value="CCC" <%= student.course === 'CCC' ? 'selected' : '' %>>CCC</option>
            <option value="Tally" <%= student.course === 'Tally' ? 'selected' : '' %>>Tally</option>
            <option value="Typing" <%= student.course === 'Typing' ? 'selected' : '' %>>Typing</option>
            <option value="Programming" <%= student.course === 'Programming' ? 'selected' : '' %>>Programming</option>
            <option value="Web Design" <%= student.course === 'Web Design' ? 'selected' : '' %>>Web Design</option>
            <option value="Graphic Design" <%= student.course === 'Graphic Design' ? 'selected' : '' %>>Graphic Design</option>
            <option value="Other" <%= student.course === 'Other' ? 'selected' : '' %>>Other</option>
          </select>
        </div>

        <!-- Contact Details -->
        <div class="form-group">
          <label>Contact Number 1 *</label>
          <input type="text" name="contact1" value="<%= student.contact1 %>" required>
        </div>

        <div class="form-group">
          <label>Contact Number 2</label>
          <input type="text" name="contact2" value="<%= student.contact2 %>">
        </div>

        <div class="form-group full-width">
          <label>Address</label>
          <textarea name="address" rows="3"><%= student.address %></textarea>
        </div>

        <div class="form-group">
          <label>Email (Optional)</label>
          <input type="email" name="email" value="<%= student.email %>">
        </div>

        <!-- Photo -->
        <div class="form-group">
          <label>Student Photo</label>
          <input type="file" name="photo" accept="image/*">
          <% if (student.photo) { %>
            <img src="<%= student.photo %>" class="preview-img">
            <input type="hidden" name="existingPhoto" value="<%= student.photo %>">
          <% } %>
        </div>

        <!-- Aadhaar Card -->
        <div class="form-group">
          <label>Aadhaar Card (Optional)</label>
          <input type="file" name="aadhaar" accept="image/*,application/pdf">
          <% if (student.aadhaarPath) { %>
            <div style="margin-top:10px;">
              <a href="<%= student.aadhaarPath %>" target="_blank" style="color:#7b2cff; text-decoration:none;">
                <i class="fa-solid fa-file-pdf"></i> View Current Aadhaar
              </a>
            </div>
          <% } %>
        </div>

        <!-- Fees -->
        <div class="form-group">
          <label>Total Fees</label>
          <input type="number" name="totalFees" value="<%= student.totalFees %>">
        </div>

        <div class="form-group">
          <label>Fees Submitted</label>
          <input type="number" name="feesSubmitted" value="<%= student.feesSubmitted %>">
        </div>

      </div>

      <button type="submit" class="btn-submit">
        <%= mode === 'edit' ? 'Update Student' : 'Register Student' %>
      </button>

    </form>
  </div>
</div>

</body>
</html>
